REM : Skrypt wklajmy w putty po połączeniu z drukarką (115200,8,1,none)
REM : W drukarce wczesniej nalezy włączyc virtualny port COM
REM :

DELETE1-100000
IMMEDIATE OFF

KEY (10) ON
KEY (11) ON
KEY (12) ON
KEY (13) ON
KEY (14) ON
KEY (16) ON
KEY (17) ON
KEY (20) ON

ON KEY (10) GOSUB SUBHOME
ON KEY (12) GOSUB SUBUP
ON KEY (14) GOSUB SUBDOWN
ON KEY (11) GOSUB SUBLEFT
ON KEY (13) GOSUB SUBRIGHT
ON KEY (16) GOSUB SUBENTER
ON KEY (20) GOSUB SUBBACK
ON KEY (17) GOSUB SUBPAPER
ON ERROR GOTO SUBERROR

100 A$="10"
110 B%=0
111 I%=0
112 NASC 8

113 LTS& ON

120 MAIN:
120 COMSET 9,"","!","","",30
121 OPEN "console:" FOR OUTPUT AS 1
122 PRINT CHR$(155)+"5p"
123 COMSET 9 ON
125 PRINT CHR$(155)+"5p"

133 ON COMSET 9 GOSUB QQQ
134 QQQ: 
135 A$=COMBUF$(9)
136 RETURN

125 READINPUT: A$=COMBUF$(9)

170 IF A$<>"" THEN C$=A$

175 T$="ARRAY$"
180 DIM ARRAY$(4)
190 I%=SPLIT(A$,T$,42)
193 IF I%=2 THEN 
194 L%=VAL(ARRAY$(0))
195 C$=ARRAY$(1)
196 ELSE L%=1

200 FONT "Univers",7
210 PRPOS 10,160
220 PRTXT "Dyskont TANIA ODZIEŻ"
230 PRPOS 10,60
240 FONT "Univers Bold",30,0,75
250 PRTXT C$
260 PRTXT "zł"
270 PRPOS 10,35
280 FONT "Univers",7
290 FORMAT DATE$ "YYYY-MM-DD" 
300 FORMAT TIME$ "HH:MM:SS" 
310 PRTXT "Data: "
320 PRTXT DATE$("F") 
330 PRTXT " "
340 PRTXT TIME$("F") 
350 PRPOS 10,10
360 FONT "Univers",7
370 PRTXT "Stanowisko 1"

510 B%=ASC(A$)
520 IF B%<>47 THEN PRINTFEED L%
530 GOTO MAIN


590 LTS& OFF
600 'SETSTDIO 100
700 END


100010  SUBHOME: 
100020  PRINT "HOME"
100030  RETURN
100040  
100050  
100060  SUBUP: 
100070  PRINT "UP UP"
100080  RETURN
100090  
100100  SUBDOWN: 
100110  PRINT "DOWN"
100120  RETURN
100130  
100140  SUBLEFT: 
100150  PRINT "LEFT"
100160  RETURN
100170  
100180  SUBRIGHT: 
100190  PRINT "RIGHT"
100200  RETURN
100210  
100220  SUBENTER: 
100230  PRINT "ENTER"
100240  RETURN
100242  SUBBACK: 
100244  PRINT "Bye"
100245  END
100250  
100260  SUBERROR:
100270  IF ERR=1022 THEN
100280  PRINT "IMAGE 4"
100290  SUBERRORLOOP:
100300  IF PRSTAT AND 1 THEN GOTO SUBERRORLOOP
100310  PRINT "IMAGE 0"
100320  RESUME
100330  ENDIF
100340  IF ERR=1005 THEN
100350  PRINT "IMAGE 3"
100360  SUBERRORLOOP2:
100370  IF (PRSTAT AND 1)=0 THEN GOTO SUBERRORLOOP2
100380  EFLAG%=0
100390  SUBERRORLOOP3:
100400  IF (PRSTAT AND 1)=0 THEN FORMFEED ELSE GOTO SUBERRORLOOP3
100410  IF EFLAG%=1005 THEN GOTO SUBERRORLOOP2
100420  IF EFLAG%=1031 THEN GOSUB SUBNOPAPER
100430  PRINT "IMAGE 0"
100440  RESUME
100450  ENDIF
100460  IF ERR=0 THEN
100470  PRINT "IMAGE 0"
100480  RESUME
100490  ENDIF
100500  IF ERR=1031 THEN
100510  SUBNOPAPER:
100520  PRINT "BRAK ETYKIETY"
100530  SUBERRORFEED:
100540  EFLAG%=0
100550  FORMFEED
100560  IF EFLAG%=1031 THEN GOTO SUBERRORFEED
100570  RETURN
100580  ENDIF
100590  GOTO SUBBACK
100600  END
100610  
100620  SUBPAPER: 
100630  PRINT "FEED"
100640  RETURN
  

IMMEDIATE ON
RUN

REM SAVE "tmp:ETYKIETA.PRG",L

REM SYSVAR(43)=1
REM COPY "/tmp/ETYKIETA.PRG","/c/scripts/ETYKIETA.PRG"
REM COPY "/tmp/ETYKIETA.PRG","/c/ETYKIETA.PRG"
REM OPEN "AUTOEXEC.BAT" FOR OUTPUT AS 1
REM PRINT#1,"RUN";CHR$(34);"ETYKIETA.PRG";CHR$(34)
REM CLOSE1

REM REBOOT

REM :## Czyszczenie pliku autostartu
REM :OPEN "AUTOEXEC.BAT" FOR OUTPUT AS 1
REM :PRINT#1,""
REM :CLOSE1





